## password Reset

برای پیدا کردن آسیب‌پذیری در فرآیند Password Reset در تست نفوذ وب، باید به نکات مهمی که می‌تواند منجر به سوءاستفاده و کنترل حساب کاربری شود توجه کنید. این آسیب‌پذیری‌ها معمولاً ناشی از ضعف در طراحی توکن‌های بازنشانی، مدیریت نشست‌ها، یا اعتبارسنجی ناقص هستند.

مراحل و نکات مهم در پیدا کردن آسیب‌پذیری Password Reset
1. بررسی مکانیزم بازنشانی رمز عبور
ببینید سیستم چگونه لینک یا توکن بازنشانی را تولید و ارسال می‌کند (مثلاً ایمیل یا پیامک).

بررسی کنید که آیا توکن‌ها به صورت تصادفی و امن (با طول و پیچیدگی کافی) تولید می‌شوند یا خیر.

توکن‌ها نباید قابل حدس زدن یا پیش‌بینی باشند.

2. تست حدس زدن یا پیش‌بینی توکن‌ها
مثال آسیب‌پذیری واقعی: اگر توکن‌های بازنشانی به صورت عددی و متوالی تولید شوند (مثلاً 28604، 28605)، می‌توانید با تغییر عدد توکن در لینک بازنشانی، به حساب‌های دیگر دسترسی پیدا کنید و رمز آن‌ها را تغییر دهید.

با تغییر پارامتر توکن در URL یا درخواست، بررسی کنید آیا امکان دسترسی یا تغییر رمز سایر کاربران وجود دارد یا خیر.

3. بررسی اعتبارسنجی توکن
آیا توکن پس از استفاده منقضی می‌شود یا می‌توان چندین بار از آن استفاده کرد؟

آیا توکن‌ها پس از مدت زمان مشخصی منقضی می‌شوند؟

آیا توکن‌ها به کاربر خاصی محدود شده‌اند یا می‌توان از توکن یک کاربر برای کاربر دیگر استفاده کرد؟

4. بررسی محافظت در برابر حملات خودکار
آیا محدودیت نرخ (rate limiting) برای درخواست‌های بازنشانی رمز عبور وجود دارد؟

آیا CAPTCHA یا مکانیزم مشابه برای جلوگیری از حملات brute force روی توکن‌ها فعال است؟

5. تست امکان افشای ایمیل‌ها یا نام‌های کاربری
بررسی کنید که آیا سیستم هنگام درخواست بازنشانی رمز عبور، اطلاعاتی مثل وجود یا عدم وجود ایمیل را به صورت متفاوت نشان می‌دهد (User Enumeration).

این موضوع می‌تواند به مهاجم کمک کند تا ایمیل‌های معتبر را شناسایی کند.

6. بررسی امنیت لینک بازنشانی
آیا لینک بازنشانی از طریق HTTPS ارسال می‌شود؟

آیا لینک حاوی شناسه کاربری (user ID) است که بتوان آن را تغییر داد و رمز حساب دیگر را بازنشانی کرد؟

آیا هدرهای امنیتی مثل Referrer-Policy تنظیم شده‌اند تا توکن در رفرر به سایت‌های دیگر نرود؟

7. بررسی ارسال ایمیل و امنیت آن
آیا دامنه ارسال‌کننده ایمیل دارای SPF، DKIM و DMARC است تا از جعل ایمیل جلوگیری شود؟

آیا ایمیل‌ها حاوی اطلاعات حساس یا لینک‌های ناامن نیستند؟

8. استفاده از ابزارهای تست و بررسی دستی
با ابزارهای پروکسی مثل Burp Suite درخواست‌های بازنشانی رمز عبور را بررسی و دستکاری کنید.

با تغییر توکن‌ها و پارامترها، واکنش سرور را تحلیل کنید.

بررسی کنید که آیا می‌توانید توکن‌ها را حدس بزنید یا از توکن‌های دیگران سوءاستفاده کنید.

نمونه آسیب‌پذیری واقعی و روش کشف آن
در یک نمونه واقعی، توکن بازنشانی رمز عبور به صورت عددی پنج رقمی و متوالی تولید می‌شد. تست نفوذگر با تغییر عدد توکن در لینک بازنشانی، توانست رمز حساب‌های دیگر را تغییر دهد و به حساب‌های آن‌ها دسترسی پیدا کند. همچنین ایمیل مدیر سایت در صفحه “about-us” موجود بود که امکان هدف‌گیری حساب مدیر را فراهم می‌کرد.

منابع معتبر برای مطالعه بیشتر
راهنمای OWASP درباره تست Password Reset:
OWASP Testing for Weak Password Reset

مقاله آسیب‌پذیری Account Takeover در لینک بازیابی رمز عبور (نمونه واقعی):
securityworld.ir - آسیب‌پذیری Account Takeover

جمع‌بندی
برای پیدا کردن آسیب‌پذیری در فرآیند Password Reset:

مکانیزم تولید و اعتبارسنجی توکن‌ها را بررسی کنید.

امکان حدس زدن یا پیش‌بینی توکن‌ها را تست کنید.

بررسی کنید که توکن‌ها پس از استفاده یا پس از مدت زمان مشخص منقضی می‌شوند.

محدودیت نرخ و مکانیزم‌های ضد خودکار (مثل CAPTCHA) را ارزیابی کنید.

امکان افشای اطلاعات کاربری یا User Enumeration را بررسی کنید.

امنیت ارسال لینک بازنشانی و ایمیل‌های ارسالی را ارزیابی کنید.

این روش‌ها به شما کمک می‌کنند تا نقاط ضعف احتمالی در فرآیند بازنشانی رمز عبور را شناسایی و از سوءاستفاده مهاجمان جلوگیری کنید.
