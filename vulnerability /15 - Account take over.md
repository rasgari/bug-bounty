## Account take over

برای پیدا کردن و تست آسیب‌پذیری Account Takeover در تست نفوذ وب، باید به موارد زیر توجه کنید:

1. بررسی فرآیند بازنشانی رمز عبور (Password Reset)
تست کنید که آیا توکن بازنشانی رمز عبور به صورت تصادفی و امن تولید می‌شود یا توکن‌ها قابل حدس زدن و متوالی هستند.

مثال واقعی: اگر توکن‌ها به صورت عددی متوالی باشند (مثلاً 28604، 28605)، می‌توانید با تغییر عدد توکن در لینک بازنشانی، به حساب‌های دیگر دسترسی پیدا کنید و رمز آن‌ها را تغییر دهید.

برای این کار:

ابتدا با حساب خودتان فرآیند Reset Password را انجام دهید.

لینک بازنشانی را دریافت و توکن آن را بررسی کنید.

عدد یا توکن را تغییر دهید و ببینید آیا امکان دسترسی به حساب‌های دیگر وجود دارد یا خیر.

همچنین بررسی کنید که آیا توکن‌ها پس از استفاده یا مدت زمان مشخص منقضی می‌شوند یا می‌توان چندین بار از آن‌ها استفاده کرد.

2. شناسایی ایمیل‌ها و حساب‌های مهم
در سایت‌ها به دنبال ایمیل‌های مدیران یا حساب‌های مهم باشید (مثلاً در صفحه “about-us” یا صفحات تماس).

با شناسایی ایمیل مدیر، می‌توانید فرآیند بازنشانی رمز عبور را روی آن حساب انجام دهید و در صورت آسیب‌پذیری توکن‌های متوالی، حساب مدیر را تصاحب کنید.

3. بررسی امکان فیشینگ و مهندسی اجتماعی
فیشینگ یکی از روش‌های رایج Account Takeover است که در آن مهاجم با ارسال لینک‌های جعلی، اطلاعات ورود را از قربانی می‌گیرد.

تست کنید که آیا سایت یا سرویس مورد نظر محافظت مناسبی در برابر فیشینگ دارد یا خیر.

4. بررسی استفاده از داده‌های افشا شده (Credential Stuffing)
بررسی کنید که آیا سایت مکانیزم‌هایی مثل محدودیت ورود (Rate Limiting)، CAPTCHA، یا احراز هویت دو مرحله‌ای دارد که از حملات Credential Stuffing جلوگیری کند.

5. بررسی آسیب‌پذیری‌های مرتبط با Headerها و پارامترها
آسیب‌پذیری‌هایی مانند Host Header Poisoning یا Open Redirect می‌توانند به مهاجم امکان تصاحب حساب را بدهند.

این موارد را در تست نفوذ بررسی کنید.

6. ابزارها و روش‌های تست
تست دستی توکن‌های بازنشانی رمز عبور: تغییر توکن‌ها در URL و بررسی پاسخ سرور

ابزارهای اسکن و فازی: استفاده از Burp Suite Intruder برای تست توکن‌ها و پارامترهای حساس

بررسی لاگ‌ها و پاسخ‌ها: تحلیل رفتار سرور در مقابل درخواست‌های متوالی و تغییر یافته

شناسایی ایمیل‌ها و حساب‌های مهم: با ابزارهای Recon مثل subfinder و جستجوی صفحات سایت

منابع مفید برای مطالعه بیشتر
آسیب‌پذیری Account Takeover در لینک بازیابی رمز عبور (securityworld.ir)

روش‌های تشخیص و مقابله با Account Takeover (cynetco.com)

آسیب‌پذیری Account Takeover در برنامه‌ی بانتی ebay (ravinacademy.com)

Host Header Poisoning و Account Takeover (memoryleaks.ir)

جمع‌بندی
برای کشف آسیب‌پذیری Account Takeover:

فرآیند Reset Password را دقیق بررسی کنید و امکان حدس زدن توکن‌ها را تست کنید.

ایمیل‌ها و حساب‌های حساس را شناسایی کنید و روی آن‌ها تست انجام دهید.

مکانیزم‌های محافظتی سایت را ارزیابی کنید (Rate Limiting، MFA، CAPTCHA).

آسیب‌پذیری‌های جانبی مثل Open Redirect و Host Header Poisoning را بررسی کنید.

این روش‌ها به شما کمک می‌کنند تا نقاط ضعف مهم در کنترل دسترسی کاربران را شناسایی و گزارش کنید.
