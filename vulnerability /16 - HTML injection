## HTML injection

آسیب‌پذیری HTML Injection زمانی رخ می‌دهد که ورودی‌های کاربر به درستی فیلتر یا اعتبارسنجی نشده و مهاجم بتواند کدهای HTML دلخواه خود را در صفحات وب سایت تزریق و اجرا کند. این آسیب‌پذیری مشابه XSS است اما در HTML Injection معمولاً فقط تگ‌های HTML (بدون اجرای کد جاوااسکریپت) تزریق می‌شوند.

چگونه HTML Injection را در تست نفوذ وب پیدا کنیم؟
1. شناسایی نقاط ورودی آسیب‌پذیر
به دنبال فرم‌ها، پارامترهای URL، فیلدهای جستجو، کامنت‌ها یا هر جایی که کاربر بتواند ورودی متنی وارد کند باشید.

ورودی‌هایی که مقدار وارد شده را در صفحه نمایش می‌دهند، گزینه‌های مناسبی برای تست هستند.

2. تزریق تگ‌های HTML ساده
در فیلد ورودی، تگ‌های ساده HTML مثل <h1>Hello</h1>، <b>Test</b> یا <img src=x onerror=alert(1)> را وارد کنید.

اگر این تگ‌ها در صفحه به صورت اجرا شده یا نمایش داده شوند، احتمال وجود آسیب‌پذیری HTML Injection وجود دارد.

3. بررسی سه حالت ممکن در واکنش سایت
حالت اول: تگ‌های HTML به درستی اجرا می‌شوند و آسیب‌پذیری تایید می‌شود.

حالت دوم: سایت به طور کامل ورودی‌ها را فیلتر می‌کند و آسیب‌پذیری وجود ندارد.

حالت سوم: سایت فیلتر دارد اما قابل دور زدن است؛ در این حالت باید از بایپس‌های مختلف استفاده کنید (مثلاً کدگذاری URL، استفاده از کاراکترهای یونیکد یا تگ‌های مخفی).

4. استفاده از ابزارهای تست و فازی کردن ورودی
می‌توانید از Burp Suite برای فازی کردن پارامترها و تزریق تگ‌های HTML استفاده کنید.

در Burp Proxy درخواست‌ها را رهگیری و در Repeater یا Intruder پیلودهای HTML را تزریق و پاسخ‌ها را بررسی کنید.

5. تست‌های پیشرفته‌تر
تزریق iframe یا تگ‌های مخرب برای بررسی iframe Injection که می‌تواند منجر به بارگذاری صفحات مخرب و سرقت اطلاعات شود.

تست ترکیبی با XSS برای بررسی امکان اجرای جاوااسکریپت در کنار HTML Injection.

مثال عملی تست HTML Injection با Burp Suite
در Burp Proxy، درخواست صفحه‌ای که ورودی دارد را رهگیری کنید.

درخواست را به Repeater ارسال کنید.

مقدار پارامتر ورودی را به <h1>Test Injection</h1> تغییر دهید.

درخواست را ارسال کنید و صفحه را بررسی کنید که آیا تگ <h1> به صورت اجرا شده یا نمایش داده شده است.

اگر اجرا شد، آسیب‌پذیری HTML Injection تایید می‌شود.

منابع آموزشی و ویدیویی فارسی
آموزش کامل HTML Injection در pentestcore.com

مقاله مفهوم و شناسایی HTML Injection در bugdasht.ir

ویدیوهای آموزشی در آپارات:

آموزش HTML Injection - قسمت اول

آموزش HTML Injection - قسمت دوم

نکات مهم
HTML Injection می‌تواند منجر به تغییر ظاهر صفحه، نمایش محتوای جعلی، فیشینگ و حتی سرقت کوکی‌ها شود.

برخلاف XSS، در HTML Injection معمولاً اجرای کد جاوااسکریپت محدود است اما باز هم خطرناک است.

همیشه ورودی‌های کاربر را به درستی فیلتر و اعتبارسنجی کنید تا از این آسیب‌پذیری جلوگیری شود.

اگر بخواهید، می‌توانم نمونه اسکریپت‌های تخصصی‌تر برای اتوماتیک‌سازی تست HTML Injection یا راهنمای گام‌به‌گام استفاده از ابزارهای Burp Suite برای این آسیب‌پذیری را هم برایتان آماده کنم.
