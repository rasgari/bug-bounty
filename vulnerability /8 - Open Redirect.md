## Open Redirect

برای پیدا کردن آسیب‌پذیری Open Redirect در تست نفوذ وب، باید ورودی‌هایی که باعث تغییر مسیر (Redirect) کاربر به آدرس‌های دیگر می‌شوند را شناسایی و تست کنید. این آسیب‌پذیری زمانی رخ می‌دهد که پارامترهای URL یا ورودی‌های برنامه به درستی اعتبارسنجی نشوند و مهاجم بتواند کاربر را به آدرس دلخواه (معمولاً مخرب یا فیشینگ) هدایت کند.

روش‌های پیدا کردن Open Redirect
1. شناسایی پارامترهای تغییر مسیر
در URLها یا فرم‌ها به دنبال پارامترهایی مثل redirect, url, next, return, page و مشابه آن‌ها بگردید.

مثال:

```bash
https://example.com/redirect.php?page=https://trusted.com
```
2. تست دستی با تغییر مقدار پارامتر به آدرس دلخواه
مقدار پارامتر را به یک URL خارجی یا مخرب تغییر دهید، مثلاً:

```bash
https://example.com/redirect.php?page=https://attacker.com
```
اگر پس از ارسال درخواست، مرورگر به آدرس جدید هدایت شود، یعنی آسیب‌پذیری Open Redirect وجود دارد.

3. بررسی رفتار برنامه
بررسی کنید که آیا برنامه ورودی را محدود یا فیلتر می‌کند (مثلاً فقط اجازه ریدایرکت به دامنه‌های مشخص را می‌دهد یا خیر).

تست کنید که آیا می‌توان با روش‌های مختلف (کدگذاری URL، استفاده از آدرس‌های کوتاه شده، استفاده از کاراکترهای خاص) فیلترها را دور زد.

4. استفاده از ابزارهای خودکار
برخی اسکنرهای امنیتی و افزونه‌های Burp Suite قابلیت شناسایی Open Redirect را دارند.

ابزارهای فازی (Fuzzer) می‌توانند پارامترها را با URLهای مختلف تست کنند.

5. بررسی صفحات و پارامترهای مشابه
گاهی پارامترهای تغییر مسیر در چند صفحه یا بخش مختلف سایت استفاده می‌شوند. همه آن‌ها را بررسی کنید.

به ویژه صفحاتی که پس از لاگین، ثبت‌نام یا عملیات خاص کاربر را ریدایرکت می‌کنند.

6. کاربرد و ریسک آسیب‌پذیری Open Redirect
مهاجم می‌تواند با ساخت لینک‌هایی که به ظاهر به سایت معتبر مربوط هستند، کاربر را به سایت فیشینگ یا مخرب هدایت کند.

این موضوع باعث افزایش موفقیت حملات فیشینگ و سرقت اطلاعات می‌شود.

7. راهکارهای امن‌سازی
محدود کردن آدرس‌های ریدایرکت به دامنه‌های مشخص و تایید شده.

استفاده از لیست سفید (Whitelist) برای مقادیر پارامترهای ریدایرکت.

جلوگیری از پذیرش URLهای کامل و فقط استفاده از شناسه‌های داخلی برای مسیرها.

اعتبارسنجی و پاکسازی ورودی‌ها.

خلاصه
Open Redirect وقتی رخ می‌دهد که پارامترهای تغییر مسیر به درستی کنترل نشوند.

برای پیدا کردن آن، پارامترهای ریدایرکت را شناسایی کرده و مقدارشان را به URLهای خارجی تغییر دهید.

اگر سایت کاربر را به آدرس دلخواه هدایت کرد، آسیب‌پذیری وجود دارد.

ابزارهای اسکنر و فازی می‌توانند روند تست را تسریع کنند.

این آسیب‌پذیری معمولاً در حملات فیشینگ استفاده می‌شود و باید با محدودسازی ورودی‌ها رفع شود.

منابع:
PentestCore - آشنایی با آسیب‌پذیری Open Redirect
IranDNN - آسیب‌پذیری Open Redirect چیست؟
ویدیو آموزش Open Redirect در آپارات
