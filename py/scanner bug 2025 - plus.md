با فشردن Ctrl + C (SIGINT) اسکن را امن متوقف کند و تا آن لحظه گزارش‌ها را ذخیره کند؛

علاوه بر report_gold.csv و report_gold.html یک خلاصه کامل هم بسازد (report_summary.txt) که شامل:

مدت‌زمان اسکن (تا لحظه توقف یا اتمام)

پر آسیب‌ترین ساب‌دامین‌ها و مسیرها (به ترتیب)

پارامترهای پرخطر که در یافته‌ها زیاد ظاهر شده‌اند (مثل id, redirect, token, ...)

برای هر یافته، زمان (timestamp) ثبت و در خلاصه قابل مشاهده است

کد کاملِ به‌روزشده را در ادامه می‌بینی — کافیست جایگزین scanner.py یا goldmine_scanner.py فعلی‌ات کنی و اجرا نمایی.

نکات اجرایی:

اجرای معمولی همان است: python scanner.py urls.txt

هنگام فشردن Ctrl + C اسکن متوقف شده و خروجی‌ها ذخیره می‌شوند.

خروجی‌ها: report_gold.csv, report_gold.html, report_summary.txt

چه چیزی اضافه شد (خلاصه)

signal handler برای SIGINT (Ctrl+C) — هنگام فشردن Ctrl+C اسکن متوقف و ذخیره می‌شود.

هر یافته حالا هنگام جمع‌آوری timestamp دریافت می‌کند.

save_csv و save_html بروزرسانی شدند تا زمان را هم در خروجی درج کنند.

فایل report_summary.txt ساخته می‌شود که شامل:

زمان شروع و پایان، مدت اسکن، تعداد یافته‌ها

پراکندگی بر اساس ساب‌دامین‌ها و مسیرها

فهرست پارامترهای پرخطر (از داخل detail/evidence)

timeline نمونه از جدیدترین یافته‌ها همراه با زمان

اگر اسکن به‌صورت زودهنگام قطع شود (Ctrl+C)، داده‌ها تا همان لحظه ذخیره خواهند شد.


==========================================================


یک نسخهٔ کامل، آمادهٔ اجرا و ارتقاء‌یافته از اسکنرت را تهیه کردم که همه‌ی خواسته‌هات را پوشش می‌دهد:

ویژگی‌ها (خلاصه)

کرالینگ و آنالیز passive روی URLهای داخل urls.txt (عمق ساده‌ و asset discovery مثل js/json).

خروجی‌ها: report.csv, report.html, report.json، report_summary.txt، versions_report.txt، cve_report.json و exploitdb_report.json.

نمایش زندهٔ پیشرفت با tqdm (progress bar + counts).

امکان تعیین مسیر خروجی با پارامتر CLI --out.

زمان‌بندی اسکن برای هر دامنه و timestamp برای هر finding.

Subdomain aggregation محدود به دامنه‌های داخل urls.txt (ساب‌دامین‌هایی که متعلق به seedها باشند).

استخراج نسخه‌های نرم‌افزار از هدرها، package.json، meta-generator (وردپرس) و جمع‌بندی جداگانه.

قابلیت فراخوانی NVD (NIST) و جستجوی ساده در Exploit-DB برای هر محصول/version کشف‌شده (با fallback و رفتار محترمانه).

قطع امن با Ctrl+C که هنگام قطع، همه فایل‌ها تا آن لحظه ذخیره می‌شوند.

نکته مهم درباره CVE/Exploit-DB:

اسکریپت از API عمومی NVD (services.nvd.nist.gov) برای جستجوی CVE‌ها استفاده می‌کند. این API ممکن است محدودیت نرخ داشته باشد (rate-limit) — اسکریپت با محدودیت پایه (sleep کوتاه) عمل می‌کند.

Exploit-DB هیچ API رسمی ساده‌ای برای جستجوی محصول/version ندارد؛ اسکریپت یک جستجوی ساده (HTML scrape) انجام می‌دهد با احترام به نرخ (و با fallback اگر بلوک شد).

برای دقت بیشتر و مقیاس‌پذیری می‌توان از mirrorها یا دیتابیس‌های آفلاین (مثلاً نسخهٔ محلی SearchSploit) استفاده کرد.

نصب پیش‌نیازها
pip install requests beautifulsoup4 tqdm

استفاده
python3 scanner_full_advanced.py urls.txt --out reports --workers 20 --depth 1 --check-cves


پارامترهای مهم:

urls.txt : لیست seed URLs (هر خط یک URL).

--out : پوشه خروجی (پیش‌فرض reports).

--workers : تعداد تردها (پیش‌فرض 20).

--depth : (اختیاری) فعلاً رفتار کرال عمیق ساده نیست — اما می‌توان این را به عنوان flag در نسخه‌های بعد اضافه کرد. (در این نسخه assets کشف و بررسی می‌شوند؛ عمق لینک‌خواری محدود است)

--check-cves : اگر فعال باشد، برای نسخه‌های کشف‌شده جستجوی NVD/Exploit-DB انجام می‌شود (ممکن است اسکن طولانی‌تر شود).

پایین، فایل کامل پایتون را کپی کن (scanner_full_advanced.py). اجرای آن همان‌طور که بالا گفته شد است.

هشدار قانونی و اخلاقی: این ابزار برای تست در محدوده مجاز طراحی شده است. قبل از اسکن هر دامنه مطمئن شو مجوز داری (باگ بانتی یا CTF یا مالک سایت). استفادهٔ غیرمجاز می‌تواند غیرقانونی باشد.

==============================================================================
