# checklist URL

ุจุฑุง ุดูุงุณุง URLูุง ฺฉู ุงุญุชูุงู ุฏุงุฑุฏ ุขุณุจโูพุฐุฑ ุงููุช ุฏุงุดุชู ุจุงุดูุฏุ ุจู ุฏูุจุงู ููุงุฑุฏ ุจูุฏู ฺฉู:

ูพุงุฑุงูุชุฑูุง ูุงุจู ุชุฒุฑู ุฏุงุฑูุฏ (ูุซู redirect_to=, url=, token=, utm_*).

ูฺฉุงูโูุง ุงุฏูู ุง ูพูุงฺฏูโูุง ุดูุงุฎุชูโุดุฏู ูุฑุฏูพุฑุณ ูุณุชูุฏ.

ูุณุฑูุง ุจุง ุฏุงุฏูโูุง ุฑูุฒฺฏุฐุงุฑโุดุฏู Base64 ุฏุงุฑูุฏ ฺฉู ููฺฉู ุงุณุช ุงูฺฉุงู ุชุฒุฑู ุง ุฏุณุชุฑุณ ุบุฑูุฌุงุฒ ุจุฏููุฏ.

ูุฌูุฏ ูุงูโูุง ุฌุงูุงุงุณฺฉุฑูพุชุ JSON ุง API endpointูุง ุจุฏูู ุงุญุฑุงุฒ ููุช.

ูููโุชุฑู URLูุง ฺฉู ูพุชุงูุณู ุขุณุจโูพุฐุฑ ุฏุงุฑูุฏ:

1. ุงุญุชูุงู Redirect ุง Open Redirect
http://snapp.ir:80/wp-login.php?redirect_to=http://snapp.ir/wp-admin/&reauth=FUZZ
ุงุญุชูุงู ุขุณุจโูพุฐุฑ Open Redirect ุฏุฑ ูพุงุฑุงูุชุฑ redirect_to.



2. Base64 ุฏุงุฎู ูพุงุฑุงูุชุฑ GET โ ุงุญุชูุงู ุชุฒุฑู ุง ุจุงุฒ ฺฉุฑุฏู ูุณุฑูุง ูุงุงูู
http://ios.snapp.ir/h/food/?aHR0c... (Base64 string)
ุงู ููุน URLโ ุจุง ูพุงุฑุงูุชุฑ ?aHR0c... ุงุญุชูุงู ุงุฌุฑุง ููฺฉโูุง ุบุฑูุฌุงุฒ ุงุฒ ุทุฑู Decode ฺฉุฑุฏู ุฏุงุฑุฏ.

ูุซุงูโูุง ูุดุงุจู:

http://ios.snapp.ir/h/train/?aHR0...

http://snapp.ir/landings/super-app-food?utm_medium=FUZZ

http://services.snapp.ir/wp-includes/js/jquery/jquery.min.js?ver=FUZZ


3. Endpointูุง REST API ูุฑุฏูพุฑุณ (/wp-json/oembed/...)

https://club.snapp.ir/wp-json/oembed/1.0/embed?url=https://club.snapp.ir/snapp-drivers-training/...
ุงฺฏุฑ ูพุงุฑุงูุชุฑ url= ุจุฏุฑุณุช ููุชุฑ ูุดุฏู ุจุงุดุฏุ ุงุญุชูุงู XSS ุง SSRF ุฏุงุฑุฏ.

4. ุงุณุชูุงุฏู ุงุฒ token= ุจุฏูู ุงุญุฑุงุฒ ููุช

https://engineering.snapp.ir/authorize-token?expires=1652104148&nightmode=FUZZ
https://engineering.snapp.ir/authorize-token?token=guest&redirectedPub=FUZZ
ุงุญุชูุงู ุณูุกุงุณุชูุงุฏู ุงุฒ ุชูฺฉู ุฏุฑ ุตูุฑุช ุนุฏู ูุญุฏูุฏุณุงุฒ IP ุง ุฒูุงู ุงููุถุง.

5. ูพูู ูุฏุฑุช ุจุฏูู ุงุญุฑุงุฒ ููุช ููุงุณุจ

http://promoclub.snapp.ir/wp-admin/?login=FUZZ
http://club.snapp.ir/promoclub/?login=FUZZ
ุงฺฏุฑ ุจุฏูู ุงุญุฑุงุฒ ููุช ุจุชูุงู ุจู ูพูู ุฏุณุชุฑุณ ุฏุงุดุช ุง ุฑูุชุงุฑ ุบุฑููุชุธุฑู ุฏุงุดุชุ ุขุณุจโูพุฐุฑ ุงุณุช.

ูพุดููุงุฏ ุจุฑุฑุณ ุฏููโุชุฑ:
ุจุฑุง ูุฑ ููุฑุฏ ุจุงูุง:

ุจุฑุฑุณ ฺฉูุฏ ุขุง ุงูฺฉุงู ุชุฒุฑู ูพุงุฑุงูุชุฑ (XSS/Redirect/SSRF) ูุฌูุฏ ุฏุงุฑุฏ.

ุจุจูุฏ ูพุงุณุฎ ุณุฑูุฑ ุฏุฑ ุจุฑุงุจุฑ ูุฑูุฏ ูุฎุฑุจ (ูุซู javascript:, data: ุง evil.com) ฺู ุฑูุชุงุฑ ุฏุงุฑุฏ.

ุชุณุช ฺฉูุฏ ุงฺฏุฑ ูพุงุฑุงูุชุฑ ุญุฐู ุง ุชุบุฑ ุงุจุฏุ ฺู ุฎุฑูุฌโุง ูโุฏูุฏ.

ุงฺฏุฑ ุฎูุงุณุชุ ูโุชููู PoC ุจุฑุง ุชุณุช ุขุณุจโูพุฐุฑ ูู ุจุฑุงุช ุขูุงุฏู ฺฉูู.

ุขุง ูโุฎูุง ฺฉู ฺฉ ุงุฒ ุงู URLูุง ุฑู ุฏููโุชุฑ ุชุณุช ฺฉููุ

========================================================================================================

ุจุฑุฑุณ ูุงูโูุง ูพูุณุชโุดุฏู ุจู ุฏูู ุญุฌู ุจุณุงุฑ ุฒุงุฏ ู ุญุฌู ุฏุงุฏูโูุง ูุชู ุญุงู URLูุง ูุชุนุฏุฏุ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ู ุฏูู ุงูฺฉุงูโูพุฐุฑ ูุณุช. ุงูุง ุจุฑุง ุชุนู ุงูฺฉู ฺฉุฏุงู URL ูโุชูุงูุฏ ุดูุง ุฑุง ุจู ุขุณุจโูพุฐุฑ ุจุฑุณุงูุฏุ ูุนูููุงู ุจุงุฏ ุงู ูฺฉุงุช ุฑุง ุจุฑุฑุณ ฺฉุฑุฏ:

ุขุง URLูุง ุดุงูู ูพุงุฑุงูุชุฑูุง ูุฑูุฏ (query parameters) ูุงุจู ุฏุณุชฺฉุงุฑ ูุณุชูุฏุ ูุซู action=, id=, token=, redirect_to=, page=, nonce=, login=, preview=, redirect_to=, password=, search=

ุขุง URL ุจู ุตูุญุงุช ูุฑูุฏ (login)ุ ูุฏุฑุช (admin)ุ ุง ajax ฺฉู ููฺฉู ุงุณุช ุถุนู ุงููุช ุฏุงุดุชู ุจุงุดูุฏ ุงุดุงุฑู ุฏุงุฑุฏุ

ุขุง URLูุง ุญุงู ูพุงุฑุงูุชุฑูุง ุฑูุฒูฺฏุงุฑ ูุดุฏู ุง ุชูฺฉูโูุง ูุณุชูุฏ ฺฉู ุงูฺฉุงู ุชุฒุฑู ุง ุฏุณุชุฑุณ ุบุฑูุฌุงุฒ ูุฑุงูู ฺฉูุฏุ

URLูุง ฺฉู ุดุงูู ฺฉููุงุช ฺฉูุฏ ุขุณุจโูพุฐุฑ ุฑุงุฌ ูุงููุฏ wp-admin, wp-login.php, admin-ajax.php, login.action, authorize-token, redirect_to, nonce, token ู ... ุงุญุชูุงู ุขุณุจโูพุฐุฑ ุจุงูุงุชุฑ ุฏุงุฑูุฏ.

ูุฌูุฏ URLูุง ฺฉู ููฺฉู ุงุณุช ุจู ุงุณฺฉุฑูพุชโูุง ุฌุงูุงุงุณฺฉุฑูพุช (js) ุฏุณุชุฑุณ ูุณุชูู ูโุฏููุฏ ูโุชูุงูุฏ ุฎุทุฑูุงฺฉ ุจุงุดุฏ.

ุฏุฑ ูุงู URLูุง ูพูุณุชโุดุฏูุ ุงู ูููููโูุง ุจู ุทูุฑ ุจุงูููู ูโุชูุงููุฏ ููุฌุฑ ุจู ุขุณุจโูพุฐุฑ ุจุงุดูุฏ (ุจู ุฏูู ุฏุงุดุชู ูพุงุฑุงูุชุฑูุง ุญุณุงุณ ุง ุฏุณุชุฑุณ ุจู ุจุฎุดโูุง ูุฏุฑุช):

http://snapp.ir:80/wp-login.php?action=FUZZ

http://snapp.ir:80/panel/wp-login.php?redirect_to=FUZZ

http://club.snapp.ir/promoclub/?login=true&back=FUZZ

https://club.snapp.ir/wp-admin/post.php?post=50669&action=FUZZ

https://club.snapp.ir/wp-json/oembed/1.0/embed?url=https://club.snapp.ir/wp-admin/post.php?post=FUZZ

https://club.snapp.ir/wp-admin/admin-ajax.php?action=FUZZ

http://club.snapp.ir/promoclub/free-corona-test/?login=FUZZ

https://kb.snapp.ir/login.action?os_destination=FUZZ

https://engineering.snapp.ir/authorize-token?expires=...&nightmode=FUZZ

https://pl.snapp.ir/home?token=FUZZ&openedVia=FUZZ

http://snapp.ir:80/wp-json/oembed/1.0/embed?url=http://snapp.ir/contact_us/&format=FUZZ

ู URLูุง ฺฉู ุดุงูู ูพุงุฑุงูุชุฑูุง ูุงููุฏ nonce=FUZZ, token=FUZZ, redirect_to=FUZZ, login=FUZZ ูุณุชูุฏ.

ุงู URLูุง ุงุญุชูุงูุงู ุจู ุตูุญุงุช ูุฏุฑุช ุง ุจุง ูพุงุฑุงูุชุฑูุง ูุฑูุฏ ุญุณุงุณ ูุฑุชุจุท ุจูุฏู ฺฉู ุฏุฑ ุตูุฑุช ูุจูุฏ ุชุฏุงุจุฑ ุงููุช ููุงุณุจ ูโุชูุงููุฏ ุจู ุขุณุจโูพุฐุฑ ููุฌุฑ ุดููุฏ.

ุจุฑุง ฺฏุฒุงุฑุด ุขุณุจโูพุฐุฑุ ุดูุง ูุงุฒ ุจู ุชุญูู ุนููโุชุฑ ฺฉุฏูุง ุณูุช ุณุฑูุฑุ ูพุงุฑุงูุชุฑูุง ูุฑูุฏุ ุชุงุฑุฎฺู ูุงฺฏโูุง ู ูุญูู ุงุนุชุจุงุฑุณูุฌ ู ุงุนุชุจุงุฑุณูุฌ ูุฌูุฒ ุฏุณุชุฑุณ ุฏุงุฑุฏ. ุตุฑูุงู ูุดุงูุฏู URLูุง ฺฉูุงุช ููโฺฉูุฏ ุงูุง URLs ุฐฺฉุฑ ุดุฏู ูโุชูุงููุฏ ููุทู ุดุฑูุน ุจุฑุฑุณ ุฏูู ุจุงุดูุฏ.

ุงฺฏุฑ ุจุฎูุงูุฏ ูโุชูุงูู ุจุฑุฎ ุงุฒ URLูุง ุฎุงุต ุง ูพุงุฑุงูุชุฑูุง ููุฑุฏ ูุธุฑ ุฑุง ุจุฑุง ุชุญูู ุฏููโุชุฑ ุจุฑุฑุณ ฺฉููุ ูุทูุงู ุขููุง ุฑุง ูุดุฎุต ฺฉูุฏ.

============================================================================================================


ุจุงุฏ ฺฉ ุงุฒ URLูุง ูพุฑุฑุณฺฉ ุฑุง ุงูุชุฎุงุจ ฺฉูู ู ุจุฑุง ุขู ฺฉ PoC (Proof of Concept) ุชูู ฺฉูู.

๐ฏ ูุฏู ุงูุชุฎุงุจโุดุฏู ุจุฑุง ุชุณุช ุขุณุจโูพุฐุฑ:
bash
Copy
Edit
http://snapp.ir:80/wp-login.php?redirect_to=http://snapp.ir/wp-admin/&reauth=FUZZ
๐ ุฏูู ุงูุชุฎุงุจ:
ูพุงุฑุงูุชุฑ redirect_to ูุณุชุนุฏ Open Redirect ุงุณุชุ ุนู ููฺฉู ุงุณุช ฺฉุงุฑุจุฑ ูพุณ ุงุฒ ูุงฺฏูุ ุจู ุขุฏุฑุณ ุฏูุฎูุงู ูฺฉุฑ ูุฏุงุช ุดูุฏ.

๐งช PoC ุจุฑุง ุชุณุช Open Redirect:
๐ ุขุฏุฑุณ ุชุณุชโุดุฏู:
plaintext
Copy
Edit
http://snapp.ir:80/wp-login.php?redirect_to=https://evil.com
โ ุณูุงุฑู ุชุณุช:
ฺฉุงุฑุจุฑ ุฑู ููฺฉ ุจุงูุง ฺฉูฺฉ ูโฺฉูุฏ.

ูุฑู ูุงฺฏู ูุฑุฏูพุฑุณ Snapp ููุงุด ุฏุงุฏู ูโุดูุฏ.

ูพุณ ุงุฒ ูุฑูุฏ (ุฏุฑ ุตูุฑุช ูููู ุจูุฏู ูุงฺฏู)ุ ฺฉุงุฑุจุฑ ุจู ุฌุง ุฏุงุดุจูุฑุฏ ูุฑุฏูพุฑุณุ ุจู https://evil.com ูุฏุงุช ูโุดูุฏ.

๐ฏ ูุชุฌู ูุทููุจ (ุงฺฏุฑ ุขุณุจโูพุฐุฑ ุจุงุดุฏ):
ูุฑูุฑฺฏุฑ ุจุฏูู ุจุฑุฑุณ ุฏุงููู ููุตุฏุ ฺฉุงุฑุจุฑ ุฑุง ุจู evil.com ูุฏุงุช ูโฺฉูุฏ.

ุฏุฑ ูุชุฌูุ ูโุชูุงู ุงุฒ ุงู ุจุฑุง ุญููุงุช ูุดูฺฏ ุงุณุชูุงุฏู ฺฉุฑุฏ.

๐ ฺฺฏููู ุงุฒ ุงู ุขุณุจโูพุฐุฑ ุฌููฺฏุฑ ูโุดูุฏุ
ุณุงุช ุงูู:

ููุท ุฏุงูููโูุง ูุฌุงุฒ (whitelisted) ุฑุง ุฏุฑ ูพุงุฑุงูุชุฑ redirect_to ูโูพุฐุฑุฏ.

ุง ููุงุฏุฑ ุฎุงุฑุฌ ุฑุง ูุงุฏุฏู ูโฺฏุฑุฏ ู ุจู ูุณุฑ ูพุดโูุฑุถ ูุฏุงุช ูโฺฉูุฏ.

โ๏ธ ูุดุฏุงุฑ:
ุจุฑุง ุชุณุช ุงู PoC:

ุงุฒ ุงุจุฒุงุฑูุง ูุงููุฏ Burp Suite, curl ุง ุญุช ูุฑูุฑฺฏุฑ ุงุณุชูุงุฏู ฺฉู.

ููุท ุฏุฑ ูุญุท ุชุณุช ุง ุจุง ุงุฌุงุฒู ุตุงุญุจ ุฏุงูููุ ุฑู ุณุฑูุฑ ุงุตู ุชุณุช ุงูุฌุงู ุจุฏู.

โ ุชุณุช ุจุง curl:
bash
Copy
Edit
curl -I "http://snapp.ir:80/wp-login.php?redirect_to=https://evil.com"
ุงฺฏุฑ ุฏุฑ ูพุงุณุฎ Location: https://evil.com ุฏุฏุ ุขุณุจโูพุฐุฑ ูุฌูุฏ ุฏุงุฑุฏ.
ุขุง ูโุฎูุง ุชุณุช PoC ุจุฑุง ฺฉ ุงุฒ URLูุง ุฏุงุฑุง ูพุงุฑุงูุชุฑ Base64 ูู ุจููุณูุ ูุซู:

ruby
Copy
Edit
http://ios.snapp.ir/h/food/?aHR0cHM6Ly9mb29kLnNuYXBwLmly...

=============================================================================================================================
