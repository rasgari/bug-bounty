 مسیر تست درگاه پرداخت:
مرحله تست	تکنیک‌ و ابزار
1. بررسی ورود / ثبت‌نام	بررسی XSS / SQLi / IDOR
2. بررسی سبد خرید	تست تغییر مبلغ، IDOR، تغییر پارامتر
3. قبل از پرداخت (درخواست POST)	بررسی تزریق مبلغ (مثلاً قیمت رو 100 تومن بزنیم)
4. بعد از برگشت از درگاه	بررسی اعتبارسنجی سمت سرور (آیا سایت فقط کد پرداخت رو چک می‌کنه یا نه؟)
5. Replay attack	ارسال مجدد فرم پرداخت نهایی با تغییر مبلغ یا پارامترهای حساس

🛠 ابزارهایی که به‌درد تست درگاه می‌خورند:
ابزار	کاربرد
🔹 Burp Suite	رهگیری و بازسازی درخواست پرداخت
🔹 Postman / curl	ارسال درخواست‌های دقیق POST/JSON
🔹 OWASP ZAP	اسکن خودکار با ابزار گرافیکی
🔹 آموزش دستی پارامترها	تزریق دستی در فیلدهای amount, merchant_id, callback_url

🎯 آسیب‌پذیری‌های رایج در سایت‌های با درگاه:
نوع آسیب‌پذیری	مثال
💸 Manipulate Payment Amount	فیلد مبلغ دستکاری شه ولی سمت سرور اعتبارسنجی نشه
🔄 Replay Attack	پرداخت موفق تکراری ارسال شه
🔓 IDOR روی سفارش‌ها	سفارش‌های دیگران دیده شه (/order?id=123)
🧱 Bypass پرداخت	با تغییر پارامتر یا با SSRF، اعتبارسنجی درگاه دور زده شه
💥 Open Redirect روی callback_url	ریدایرکت بعد از پرداخت به سایتی دیگه انجام شه
🐞 Race Condition	همزمان چند درخواست برای پرداخت فرستاده شه

✅ چک‌لیست تست درگاه پرداخت
 آیا فیلدهای مبلغ و order_id در front تغییر می‌پذیرند؟

 آیا پاسخ درگاه صرفاً با بررسی status=OK اعتبارسنجی می‌شه؟

 آیا callback_url کنترل می‌شه؟ (آسیب‌پذیری Redirect)

 اگر پرداخت با موفقیت انجام بشه، آیا توکن یا Session کاربر ذخیره می‌شه؟

 آیا کد تراکنش قابل حدس زدنه؟ (transaction_id=12345)

 اگر دو بار روی دکمه پرداخت بزنم چه می‌شه؟ Race؟
