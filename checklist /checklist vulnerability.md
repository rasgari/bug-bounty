

جمع‌بندی کامل برای تست نفوذ وب (Web Penetration Testing Workflow)
1. جمع‌آوری اطلاعات (Reconnaissance)
شناسایی دامنه و ساب‌دامین‌ها:
ابزار: subfinder, amass, crt.sh

یافتن IPها و سرورها:
ابزار: nmap, shodan

بررسی تکنولوژی‌ها و ورژن‌ها:
ابزار: Wappalyzer, WhatWeb

بررسی فایل‌های عمومی و مستندات:
robots.txt, sitemap.xml, فایل‌های README و changelog

استخراج اطلاعات از DNS و WHOIS

2. شناسایی نقاط ورودی و سطح حمله
شناسایی پارامترهای GET و POST، کوکی‌ها، هدرها

بررسی صفحات فرم، لاگین، API endpointها

بررسی درخواست‌های جاوااسکریپت (با DevTools)

3. تست آسیب‌پذیری‌های رایج (OWASP Top 10)
Injection:
SQLi (SQL Injection)، Command Injection، LDAP Injection

XSS:
Reflected، Stored، DOM-based

Broken Authentication:
Credential stuffing، brute force، session fixation

Broken Access Control:
IDOR، privilege escalation

Security Misconfiguration:
تنظیمات نادرست وب‌سرور، HTTP headers

Sensitive Data Exposure:
داده‌های حساس در URL، کوکی ناامن، انتقال داده ناامن (HTTP به جای HTTPS)

XXE:
حملات XML External Entity

Insecure Deserialization:
حملات با استفاده از داده‌های سریالیزه شده

Using Components with Known Vulnerabilities:
بررسی نسخه‌ها و آسیب‌پذیری‌ها

Insufficient Logging & Monitoring:
بررسی اینکه لاگ‌ها به درستی ثبت می‌شوند یا خیر

4. تست آسیب‌پذیری‌های پیشرفته و خاص
SSRF:
سرور درخواست به منابع داخلی بفرستد

Race Conditions:
بررسی شرایط همزمانی

Logic Flaws:
خطاهای منطقی در فرآیندها (مثلاً بای‌پس کردن پرداخت)

Cache Poisoning:
تغییر محتوای کش شده

File Upload Vulnerabilities:
آپلود فایل مخرب و اجرای آن

Authentication Bypass:
بررسی MFA و مکانیزم‌های امنیتی دیگر

5. تست امنیت سمت کلاینت
بررسی XSS در DOM

بررسی CSP و اعمال محدودیت‌ها

تست کوکی‌ها (HttpOnly، Secure، SameSite)

بررسی ذخیره‌سازی ناامن داده‌ها در LocalStorage و SessionStorage

6. ابزارهای کلیدی در تست نفوذ وب
Burp Suite:

Repeater, Intruder, Scanner

OWASP ZAP:
اسکنر متن‌باز

ffuf, wfuzz:
فازی تست برای پیدا کردن پارامترها و مسیرها

Nuclei:
اسکنر آسیب‌پذیری سریع و قالب‌دار

Nmap:
اسکن پورت و سرویس‌ها

Amass:
جمع‌آوری اطلاعات دامنه

Chrome DevTools:
برای بررسی درخواست‌ها و Debug جاوااسکریپت

7. گزارش‌دهی (Reporting)
نوشتن PoC (Proof of Concept) واضح و قابل فهم

توضیح گام‌به‌گام برای بازتولید آسیب‌پذیری

ارائه پیشنهادات رفع مشکل

رعایت نکات امنیتی در گزارش (مثلاً مخفی‌سازی اطلاعات حساس)

نکته حرفه‌ای
همیشه دنبال ترکیب چند باگ باشید (Chaining) تا حمله پیچیده‌تر و مخرب‌تری بسازید

بررسی APIها و اپ موبایل، چون اغلب جاهای مهم‌تر آنجاست

همیشه چندین بار تست دستی کنید، ابزارها فقط کمکتان می‌کنند نه جایگزین شما هستند


===========================================================================
===========================================================================

قالب آماده تست نفوذ وب (Web Penetration Testing Template)
1. اطلاعات اولیه هدف (Target Information)
آیتم	توضیحات	مثال/ابزار
دامنه اصلی	آدرس وبسایت یا API	example.com
ساب‌دامین‌ها	لیست ساب‌دامین‌های شناسایی شده	api.example.com, dev.example.com (ابزار: amass, subfinder)
IP و شبکه هدف	آی‌پی یا رنج آی‌پی	192.168.1.1/24 (nmap, shodan)
تکنولوژی‌ها	زبان برنامه‌نویسی، فریم‌ورک‌ها	PHP 7.4, Apache 2.4, React (Wappalyzer)
API endpointها	آدرس‌های API شناسایی شده	api.example.com/v1/users
مستندات مرتبط	robots.txt, sitemap.xml	http://example.com/robots.txt

2. جمع‌آوری اطلاعات (Reconnaissance)
استفاده از amass برای جمع‌آوری ساب‌دامین:

```bash
amass enum -d example.com
```
اسکن پورت‌ها و سرویس‌ها:

```bash
nmap -sV -p- example.com
```

بررسی تکنولوژی‌ها با Wappalyzer یا WhatWeb

بررسی فایل‌های عمومی:
مرور robots.txt, sitemap.xml

3. شناسایی نقاط ورودی و پارامترها
جمع‌آوری پارامترهای GET و POST با Burp Suite Proxy یا Chrome DevTools

فهرست صفحات دارای فرم و API Endpointها

بررسی کوکی‌ها و هدرها برای اطلاعات نشست

4. تست آسیب‌پذیری‌ها
نوع آسیب‌پذیری	ابزار/روش	نمونه تست / دستور	یادداشت
SQL Injection	sqlmap, manual payloads	sqlmap -u "http://example.com?id=1" --batch	تست دستی با ' OR 1=1--
XSS	Burp Suite, manual scripts	وارد کردن <script>alert(1)</script> در فرم‌ها	تست Reflected و Stored
Broken Auth	Burp Intruder, Hydra	Brute force روی صفحه لاگین	بررسی lockout و MFA
IDOR	دستکاری پارامترها در URL	تغییر user_id=123 به user_id=124 در URL	بررسی دسترسی ناخواسته
File Upload	آپلود فایل‌های مخرب	آپلود فایل php یا js و اجرای آن	بررسی محدودیت‌ها
SSRF	فازی تست روی پارامترهای URL	ارسال آدرس‌های داخلی به پارامترهای URL	آزمایش با http://127.0.0.1

5. تست امنیت سمت کلاینت
بررسی XSSهای DOM با DevTools و Burp

مشاهده و تحلیل هدرهای امنیتی (CSP, X-Frame-Options)

بررسی کوکی‌ها:

HttpOnly

Secure

SameSite

6. گزارش باگ (Report Template)
عنوان آسیب‌پذیری
مثال: SQL Injection در پارامتر id

توضیح مشکل
پارامتر id در صفحه‌ی example.com در برابر SQL Injection آسیب‌پذیر است و امکان دسترسی به داده‌های غیرمجاز وجود دارد.

گام‌های بازتولید (Steps to Reproduce)
وارد آدرس http://example.com?id=1 شوید

در پارامتر id مقدار ' OR '1'='1 را وارد کنید

مشاهده می‌کنید که داده‌ها بدون محدودیت نمایش داده می‌شوند

تاثیر (Impact)
دسترسی غیرمجاز به داده‌ها، نشت اطلاعات حساس، احتمال سرقت داده

راهکار پیشنهادی (Mitigation)
استفاده از prepared statements و sanitize کردن ورودی‌ها

پیوست‌ها (PoC)
اسکرین‌شات از صفحه

لاگ درخواست و پاسخ Burp Suite

7. نکات پایانی
همیشه تست‌ها را چند بار انجام دهید

از ترکیب آسیب‌پذیری‌ها استفاده کنید (مثلا XSS+CSRF)

گزارش کامل و شفاف بنویسید، تا تیم امنیتی به راحتی بتواند آن را رفع کند

اگر دوست داری، می‌تونم یک فایل PDF یا Markdown این قالب رو هم برات آماده کنم یا یک نمونه گزارش کامل از یک تست واقعی رو با جزییات بیشتر بدم.


====================================================================
====================================================================

